{ Естественное (Неймановское) слияние. }

Repeat {Повторение актов слияний подсписков}
  If A[j].kl < A[i].kl Then {Выбирается меньшая запись}
    Begin
      sp[k] := j;
      k := j;
      j := sp[j];
      If j<=0 Then {Сцепление с остатком "i"-подсписка}
        Begin
          sp[k] := i;
          Repeat
            m := i;
            i := sp[i]
          Until i<=0
        End
    End
  Else
    Begin
      sp[k] := i;
      k := i;
      i := sp[i];
      If i<=0 Then {Сцепление с остатком "j"-подсписка}
        Begin
          sp[k] := j;
          Repeat
            m := j;
            j := sp[j]
          Until j<=0
        End
    End;
  If j<=0 Then
    Begin
      sp[m] := 0;
      sp[p] := -sp[p];
      i := -i;
      j := -j;
      If j<>0 Then p := r;
      k := r;
      r := m
    End
Until j=0;

{В конец сформированного подсписка всегда заносится нулевая ссылка (sp[m]:= 0),
ибо он может оказаться последним.

Действие sp[p]:= -sp[p] обозначает минусом конец ранее построенного подсписка.


В переменных i,j ссылки на начала новых сливаемых подсписков - со знаком минус; его снимаем.
Переход к новым подспискам требует обновления переменных p, k, r}
